Requirements
1. Support element transformation - markdown like experience
2. Extendable component library
3. Page hierarchy support - meaning a page can be inside a page
4. Accessible
5. App performance
6. Offline support
7. Database support - ability to group pages
8. Crossplatform support


Mock up
![[Pasted image 20240610185507.png]]

High level

`MutationObserver` - Watch for changes made to the DOM tree and execute callbacks.

![[Pasted image 20240610190333.png]]
Note here we split page content to static area ( area we are not modifying currently) and selected area ( area we are currently editing ), so that we can cache the static area.


Components hierarchy

![[Pasted image 20240610190551.png]]

API design

getPage() - returns the page

updatePage() - sends a delta (changes between previous version of page and current version of page, probably through some third party library, instead of everything for performance optimisation) 


subscribePage() - subscribe to changes from server


subscription - eg. via SSE

GraphQL - in addition to queries and mutations, GraphQL supports subscriptions.
Subscriptions are intended to be used to subscribe to external data changes.

They are ideal for low-latency, real time updates. Eg. chat

Also provides type safety, as we need to define schema that describe the entities.

Client defines the query which is validated against graphQL schema at compile time, ensuring only valid queries are executed.

GraphQL protocol does not define a specific protocol for subscription requests, Apollo uses WebSocket.

Weakness is that with bad queries, we can pull a lot of data (unnecessary ones)


Service worker
JS files that run in the background on separate threads from the main thread. 

They act as a proxy between web app and network, intercepting network requests between webapp and server.

They allow web app to work offline by caching resources required for app to function.

Eg - intercepting network requests and serving cached resources when offline.

Note traditionally, HTMLs are not compiled into bundle like CSS and Javascript. HTML are usually static files served directly by the web server.

For web apps like a React SPA, web server usually sends a single HTML which is typically minimal, along with references to JS and CSS bundles generated by the build process.

Once JS bundle is loaded and executed, it dynamically builds UI, 

